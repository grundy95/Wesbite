"0","set.seed(2)"
"0","Xalt = c(rnorm(500),rnorm(500,2))"
"0","nAlt = length(Xalt)"
"0","cusumAlt = c()"
"0","for(k in 1:(n-1)){"
"0","	cusumAlt[k] = sqrt((k*(n-k))/n)*abs(mean(Xalt[1:k])-mean(Xalt[(k+1):n]))"
"0","}"
"0","set.seed(4)"
"0","Xnull = rnorm(1000)"
"0","nNull = length(Xnull)"
"0","cusumNull = c()"
"0","for(k in 1:(n-1)){"
"0","	cusumNull[k] = sqrt((k*(n-k))/n)*abs(mean(Xnull[1:k])-mean(Xnull[(k+1):n]))"
"0","}"
"0","X = tibble('Time'=1:n, 'None'=c(cusumNull,NA), 'One'=c(cusumAlt, NA))%>%"
"0","  pivot_longer(!Time, names_to='Changepoints', values_to='CUSUM')"
"0","ggplot(X, aes(x=Time, y=CUSUM))+"
"0","  geom_line(aes(col=Changepoints))+"
"0","  geom_hline(yintercept=3.23)+"
"0","  annotate(geom='text', y=3.23, x=500, vjust=-0.5, label='threshold=3.23')"

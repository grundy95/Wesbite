"0","set.seed(1)"
"0","X = c(rnorm(500),rnorm(500,2))"
"0","n = length(X)"
"0","cusum = c()"
"0","for(k in 1:(n-1)){"
"0","	cusum[k] = sqrt((k*(n-k))/n)*abs(mean(X[1:k])-mean(X[(k+1):n]))"
"0","}"
"0","p1 = ggplot(mapping=aes(x=1:1000, y=X))+"
"0","	geom_line()+"
"0","	labs(x='Time', y='Value')"
"0","p2 = ggplot(mapping=aes(x=1:1000, y=c(cusum,NA)))+"
"0","	geom_line()+"
"0","	labs(x='Time', y='CUSUM Statistic')"
"0","grid.arrange(p1, p2, nrow=2)"
